"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ProjectMerger = void 0;
const typedoc_1 = require("typedoc");
/**
 * Merger that moves the content of all modules into the project root.
 */
class ProjectMerger {
    /**
     * Creates a new merger instance.
     * @param project The project whose modules are merged.
     */
    constructor(project) {
        this.project = project;
    }
    /**
     * Performs the merging routine.
     */
    execute() {
        var _a, _b;
        const modules = ((_a = this.project.children) !== null && _a !== void 0 ? _a : []).filter((c) => c.kindOf(typedoc_1.ReflectionKind.Module));
        if (modules.length > 0) {
            this.project.children = [];
            for (const mod of modules) {
                const reflections = (_b = mod.children) !== null && _b !== void 0 ? _b : [];
                for (const ref of reflections) {
                    // Drop aliases
                    if (!ref.kindOf(typedoc_1.ReflectionKind.Reference)) {
                        ref.parent = this.project;
                        this.project.children.push(ref);
                    }
                }
                delete mod.children;
                this.project.removeReflection(mod);
            }
        }
    }
}
exports.ProjectMerger = ProjectMerger;
